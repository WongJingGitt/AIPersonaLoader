# PersonaLoader for AI / AI 人设加载器

<p align="center">
  <img src="https://wongjinggitt.github.io/images/%E5%85%B6%E4%BB%96/PersonaLoaderBanner.jpeg" alt="PersonaLoader 宣传图" width="900" height="320">
</p>

<p align="center">
  <strong>一处配置，多平台无缝注入。让每个 AI 从第一句话就“认识”你。</strong>
</p>

<p align="center">
  <a href="#-核心功能">核心功能</a> •
  <a href="#-新增亮点">新增亮点</a> •
  <a href="#-支持的ai平台">支持平台</a> •
  <a href="#-使用方式">使用方式</a> •
  <a href="#-工作原理">工作原理</a> •
  <a href="#-后续展望">后续展望</a>
</p>

---

**PersonaLoader** 是一款浏览器插件，旨在无缝地将您预设的**多套个性化人设**（如个人背景、输出风格、关键记忆）注入到您与主流 AI 的对话中。它解决了在不同 AI 平台间反复设置、难以统一管理个人偏好的痛点，让 AI 从始至终都能提供高度定制化的回复。

> 这款插件的核心灵感来源于 ChatGPT 的**自定义指令 (Custom Instructions)** 和 **GPTs** 功能，并将其体验带到了更多尚不支持此功能的 AI 平台。

## ✨ 核心功能

1.  **即时个性化增强**
    *   **深度理解**：让 AI 从对话的**第一句话**开始就了解您的身份、偏好、特定需求或任何您希望它知道的上下文信息。
    *   **省时高效**：无需在每次新对话时手动重复输入冗长的个人设定或指令。

2.  **跨平台人设统一管理**
    *   **集中配置**：在插件的设置中心统一创建并管理您的多套人设方案。
    *   **一处修改，多处同步**：告别个人 AI 配置信息散落在不同平台、难以统一维护的痛点。

3.  **无感智能注入**
    *   **后台自动运行**：插件在后台自动监测 AI 聊天请求。
    *   **精准触发**：仅在识别到**新对话开始**或**手动刷新**时，于您发送的消息中悄无声息地注入预设信息。
    *   **流畅体验**：几乎无需改变现有 AI 使用习惯，即可享受“量身定制”的回复。

4.  **赋能更多 AI 平台**
    *   **弥补功能空白**：特别针对许多尚缺乏内置个性化配置功能的 AI 工具，提供强大的补充。
    *   **提升输出质量**：帮助用户在各类 AI 平台上都能快速获得符合个人需求的、高质量的输出。

## 🚀 新增亮点 (v2.0)

*   **多套人设系统**：
    *   **创建与管理**：在设置页面可以自由创建、重命名、删除多套不同的人设方案（例如“工作助理”、“创意写作伙伴”、“日常闲聊”）。
    *   **一键切换**：在插件的弹出窗口中，通过下拉菜单轻松切换当前要激活的人设，即时生效。
*   **现代化 UI/UX**：
    *   **全新弹出窗口**：重新设计的弹出窗口，集成了全局开关、人设快速切换器、站点启用列表和设置入口，美观且高效。
    *   **强大的设置页面**：采用侧边栏布局，清晰地分离了人设管理和内容编辑，提供了更专业、更流畅的配置体验。
*   **站点独立开关**：
    *   在插件的弹出窗口中，可以为每个支持的网站单独开启或关闭人设注入功能，提供更精细的控制。

## ✅ 支持的AI平台

目前已适配以下 AI 平台，更多平台正在持续添加中：

*   [DeepSeek](https://chat.deepseek.com/)
*   [腾讯元宝](https://yuanbao.tencent.com/)
*   [通义千问](https://www.tongyi.com/)
*   [豆包AI](https://www.doubao.com/chat/)
*   [ChatGPT](https://chatgpt.com/)
*   *更多平台适配中...*

## 🛠️ 使用方式

1.  克隆本仓库或下载 ZIP 压缩包到本地。
2.  在 Chrome/Edge 浏览器中打开 `chrome://extensions/` 页面。
3.  点击右上角，启用 **“开发者模式”**。
4.  将解压后的整个 `AIPersonaLoader` 文件夹拖拽到该页面中完成安装。
5.  点击浏览器工具栏上的插件图标，会弹出控制窗口。
6.  在弹窗中点击 **“详细设置 & 人设管理”** 进入配置页面。
7.  在设置页面创建并编辑您的人设信息。
8.  回到弹窗，从下拉菜单中**选择您想激活的人设**。
9.  访问任一受支持的 AI 网站，开始新的对话，体验个性化回复！
    > **注意**：首次安装后，如果您的 AI 网站已经打开，请**刷新页面**以确保插件脚本成功加载。

## ⚙️ 工作原理

插件的核心逻辑是：**在 AI 聊天接口的请求发送之前，通过脚本拦截并修改请求体，将当前激活的人设信息植入其中。**

1.  **内容脚本注入**：当您访问一个受支持的网站时，插件会注入一个 `content script`。这个脚本作为“桥梁”，负责与插件的后台服务通信，并准备拦截环境。
2.  **Hook 脚本加载**：`content script` 会向页面注入一个轻量级的 `hook` 脚本，用于覆写 `fetch` 和 `XMLHttpRequest` 的原生方法。
3.  **请求拦截与判断**：当页面发起网络请求时，`hook` 脚本会捕获它。插件会根据预设的 API 地址判断这是否是一个聊天请求。
4.  **动态注入**：
    *   如果判断为**新对话**的首次请求，插件会从 `chrome.storage` 中读取**当前激活的人设数据**。
    *   将您的提问与人设数据格式化为一个完整的 Prompt。
    *   用这个新的 Prompt 替换原始请求体中的内容，然后放行请求。
5.  **无感操作**：所有非聊天请求和非首次对话的请求都会被直接放行，不作任何修改，确保网站功能正常。

## 🔒 数据隐私

*   **纯本地存储**：您的所有人设数据（个人信息、输出规范、记忆等）都**只存储在您本地浏览器的 `chrome.storage.local` 区域中**。
*   **无数据上传**：插件代码中不包含任何将您的配置数据上传到任何服务器的逻辑。
*   **开源透明**：整个项目代码完全开源，您可以随时审查 `background.js` 和其他脚本以验证其行为。

## 📅 后续展望 (TODO LIST)

- [ ] **Token 长度与智能截断**：
    -   当人设信息过长时，可能会超出模型的上下文限制。未来将考虑引入智能截断或摘要功能，以确保核心信息能被注入。
- [ ] **更多 AI 平台适配**：
    -   持续跟进并适配国内外更多主流的 AI 对话平台。
- [ ] **人设导入/导出**：
    -   提供 JSON 格式的人设导入和导出功能，方便用户备份和分享自己精心调校的人设方案。
- [ ] **变量支持**：
    -   在人设内容中支持使用动态变量（如 `{{DATE}}`），在注入时自动替换为当前日期等信息。